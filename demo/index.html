<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <!-- Prevent the conditional comments from stalling page load -->
  <!--[if IE]><![endif]-->

  <title>Demo - Annotator - Annotating the Web</title>

  <!--[if lt IE 9]>
  <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href='//fonts.googleapis.com/css?family=Arvo:regular,bold&amp;subset=latin' rel='stylesheet' />
  <link href='//fonts.googleapis.com/css?family=Inconsolata&amp;subset=latin' rel='stylesheet' />
  
  <link href="//assets.annotateit.org/annotator/v1.2.7/annotator.min.css" rel="stylesheet" />
  <link href="../main.css" rel="stylesheet" />
</head>
<body>
  <div id="airlock">
    <header>
      <h1>
        <a href="../" title="The Annotator Homepage">Annotator</a>
      </h1>
      <nav>
        <ul>
          <li><a href="//github.com/okfn/annotator/" title="Check out the repository">Code</a></li>
          <li><a href="//github.com/okfn/annotator/downloads/" title="Download a packaged bundle">Download</a></li>
          <li><a href="//github.com/okfn/annotator/wiki/" title="Read the wiki">Wiki</a></li>
          <li><a href="//github.com/okfn/annotator/issues/" title="Report an issue">Issues</a></li>
        </ul>
      </nav>
    </header>
    <article>
      <section>
        <h2>The Annotator Demo</h2>
        <p>Annotator is a Javascript shim that you can insert into any page, allowing
           you to select and annotate text, images, or (almost) anything else.</p>

        <p><strong>How do I use it?</strong> We think you'll get the hang of it
           pretty quickly. It's running right now on this page &mdash; try it out
           by selecting some text and clicking on the note icon. Enter a note and
           press <tt>&ldquo;Enter &#x21A9;&rdquo;</tt>: you should see your annotation
           as a highlighted piece of text. Hover over the highlight with your mouse
           to view, edit and delete the annotation.</p>

        <p><strong>What happens to my annotations?</strong> The annotations on
           this page are being sent to
           <a href="//annotateit.org">AnnotateIt</a> an online web service
           for storing annotations. However it's simple to set up your own
           store. Check out the <a href="//github.com/okfn/annotator/wiki/Storage">Storage</a>
           and <a href="//github.com/okfn/annotator/wiki/Annotation-format">Annotation Format</a>
           wiki pages for more details.</p>

        <p><strong>Give me the code!</strong> Right, go get a tagged release from
           <a href="https://github.com/okfn/annotator/downloads">this page</a>,
           load <code>annotator.min.js</code> and <code>annotator.min.css</code> into
           your page, and add the following Javascript<sup><a href="#jquery">1</a>
           </sup>:</p>

        <pre><code>$('body').annotator()</code></pre>

        <p>If that doesn't make any sense to you, then go see the wiki page on <a href="//github.com/okfn/annotator/wiki/Getting-Started">Getting Started</a> for more information.</p>

        <p class="footnote">
          <a name="jquery">1</a>: I'm assuming you're already using <a href="//jquery.com">jQuery</a>, right?
          If not you'll need to load that too. Best use Google's CDN with a URL like
          <code>//ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js</code>.
        </p>
      </section>
    </article>
    <footer>
      <p>Annotator was developed by the
        <img src="//assets.okfn.org/images/logo/okf_logo_white_and_green_tiny.png" id="footer-okf-logo" />
        <a href="//okfn.org">Open
        Knowledge Foundation</a> with support from the <a
        href="//www.shuttleworthfoundation.org/">Shuttleworth
        Foundation</a>. Go see what other cool stuff we're doing at the
      moment!</p>
      <div class="widget-area">
        <ul class="xoxo">
          <li class="widget-container widget_text">
          <h3 class="widget-title"></h3>
          <div class="text-widget">
            <ul>
              <li>
                &copy; <a href="//www.okfn.org/">Open Knowledge Foundation</a>
              </li>
              <li>
                <a href="//opendefinition.org/okd/" class="img">
                <img alt="This Content and Data is Open" src="//assets.okfn.org/images/ok_buttons/oc_80x15_blue.png" class="button" />
                </a>
              </li>
              <li>
                <a href="//opendefinition.org/ossd/" class="img">
                <img alt="This Content and Data is Open"
                  src="//assets.okfn.org/images/ok_buttons/os_80x15_orange_grey.png" class="button" />
                </a>
              </li>
            </ul>
          </div>
          </li>
        </ul>
        <ul class="xoxo">
          <li class="widget-container widget_text">
            <h3 class="widget-title"></h3>
            <div class="textwidget">
              <ul>
                <li>
                  <a href="//okfn.org/projects/annotator/">Project Home Page</a>
                </li>
                <li>
                <a href="/api/">API</a>
                </li>
                <li>
                  <a href="//github.com/okfn/annotator-store/">API Docs</a>
                </li>
                <li>
                  <a href="//lists.okfn.org/mailman/listinfo/annotator-dev">Mailing List</a>
                </li>
                <li>
                  <a href="//okfn.org/privacy-policy/">Privacy Policy</a>
                </li>
              </ul>
            </div>
          </li>
        </ul>
      </div>
    </footer>
  </div>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script src="jwt.js"></script>
  <script src="//assets.annotateit.org/annotator/v1.2.7/annotator-full.min.js"></script>
  <script src="../main.js"></script>
  <script>
    if (!Date.prototype.toISOString) {
      Date.prototype.toISOString = function() {
        function pad(n) { return n < 10 ? '0' + n : n; }
        return this.getUTCFullYear() + '-'
            + pad(this.getUTCMonth() + 1) + '-'
                + pad(this.getUTCDate()) + 'T'
                    + pad(this.getUTCHours()) + ':'
                        + pad(this.getUTCMinutes()) + ':'
                            + pad(this.getUTCSeconds()) + 'Z';
      };
    }

    // Please note that you would *never* expose the consumer secret in this way
    // for an ordinary application. For the purposes of convenience for this demo, we do.
    var demoConsumerKey = 'd4c108122b51434aab1d27ad4ebd2b02';
    var demoConsumerSecret = '36977e7b-be7f-4b57-a9eb-9617e4740b6a';

    function getAuthToken(consumerKey, consumerSecret, userId) {
      "use strict";

      var date = new Date(new Date() - 1 * 60 * 60 * 1000), // 1 hour ago
          alg = { typ:'JWT', alg:'HS256' },
          payload = {
            consumerKey: consumerKey,
            userId: userId,
            issuedAt: date.toISOString(),
            ttl: 86400
          },
          token;

      alg = JSON.stringify(alg);
      payload = JSON.stringify(payload);
      token = new jwt.WebToken(payload, alg);

      return token.serialize(consumerSecret);
    }

    function initAnnotator(json) {
      "use strict";

      $('article').annotator().annotator('setupPlugins', null, {
        Auth: {
          token: getAuthToken(demoConsumerKey, demoConsumerSecret, json.ip)
        },
        Permissions: false,
        AnnotateItPermissions: {}
      });
    }
  </script>
  <script type="application/javascript" src="//jsonip.com/initAnnotator"></script>
</body>
</html>
